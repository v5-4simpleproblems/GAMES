<!DOCTYPE html>
<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1609993827735056"
  crossorigin="anonymous"
></script>
<html lang="en">
  <head>
    <!-- Include Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-database-compat.js"></script>
    <script type="module">
      // Here are the key(s) for each game that'll be saved, each should be an array to make it work.

      // Polytrack keys
      const polytrackKeys = [
        "v1_record_445edfa992d0b19b376c8072692f69eafc4afeceb608ba355d44b3cb57a902a0",
        "v1_record_55a26267e4fa6a176ba5898b3e1354d54bbf7c02ed0fd3f37e4e3cee56724a8a",
        "v1_record_60b9020ffd46fa428ce40ab2e610992d4bcd2df68f00005c6b88544ce134f950",
        "v1_record_764e05d5eb827c3b608b288cdffc3dc29be2abcc5d29cf958b029badf1564417",
        "v1_record_8b4383a77d1f900b5beff053aee8a1bc47a733778dac54f6ecca0dd6cffeec80",
        "v1_record_ed65907f59ece7a863e9f1ea1e2b50714920899f7d2e42d9b9656bcb8382b66a",
        "v1_record_f67a25877dbbdb5287f9191cda506a254b0ca7a95fde82e34951fe55bb04c172",
      ];
      // Babel tower keys that need to be saved:
      const babelTowerKeys = [
        "Tower_id",
        "W_3_numGiftsAlreadyGiven",
        "W_3_timeOfNextGift",
        "save_version",
        "save_date",
        "save_data",
      ];
      // Idle Shark key
      const idleSharkKey = ["sharkGameSave"];
      // Cookie Clicker key
      const cookieClickerKey = ["CookieClickerGame"];

      // FUNCTIONS //

      // Function to parse retrieved content given its key
      function getParsedItem(key) {
        const item = localStorage.getItem(key);
        try {
          return JSON.parse(item); // Attempt to parse as JSON
        } catch (error) {
          console.warn(`Invalid JSON for key: ${key} Error message: ${error}`);
          return item; // Return raw string if not JSON
        }
      }

      function copyText(text) {
        // Make sure document body is focued before attempting to add text to clipboard
        navigator.clipboard
          .writeText(text)
          .then(() => showTransferInstructions())
          .catch(err => alert(`Error: failed to copy your save data: ${err}`));
      }

      function showTransferInstructions() {
        alert(
          "Your save data was successfully copied to your clipboard!\nTo transfer your save data to either strongdogxp.github.io or mathcordxp.github.io, please navigate to the home page of either website and in the red updates box, there will be further instruction.\n\nMAKE SURE to not copy anything to your clipboard before transferring your data!"
        );
      }

      function setDataInObject(dataObj) {
        Object.entries(dataObj).forEach(([key, value]) => {
          const finalValue = typeof value === "string" ? value : JSON.stringify(value);
          localStorage.setItem(key, finalValue);
        });
      }

      function validateData(dataObj) {
        // Check if all keys have non-null values
        return Object.values(dataObj).every(value => value !== null);
      }

      function getAndBundleDataIntoObj(keysArr) {
        const dataObj = Object.fromEntries(keysArr.map(key => [key, getParsedItem(key)]));
        if (!validateData(dataObj))
          alert(
            "(If you retrieved Polytrack saves this isn't a problem, please move on)\n\nYour save data will be copied, but some could not be retrieved which may cause problems importing this data. Please ensure all required keys of your game sava data you're trying to transfer are present in localStorage and try again.\n\nIf this issue persists, report the error to the bug report form or message us on Discord."
          );
        return JSON.stringify(dataObj);
      }

      function getDataAndCopy(keysArr) {
        // Create object with correct key-value pairs within as displayed in local storage
        const gameData = getAndBundleDataIntoObj(keysArr);
        if (gameData) copyText(gameData);
        else return;
      }

      // When the page loads...
      document.addEventListener("DOMContentLoaded", function () {
        if (window.location.hostname.includes("netlify.app")) {
          // Replace the body content with message
          document.body.innerHTML = `
            <div style="padding: 20px; text-align: center; color: white; background-color: #333; font-family: Arial, sans-serif;">
              <p>Hi there! If you're seeing this, you're trying to connect to a StrongDog version hosted on Netlify. Due to Netlify's extreme costs, we're moving back to GitHub with updated links!</p>
              <p>Here are the new links that should be used from now on:</p>
              <p><a href="https://strongdogxp.github.io" style="color: orange;">strongdogxp.github.io</a></p>
              <p><a href="https://mathcordxp.github.io" style="color: orange;">mathcordxp.github.io</a></p>
              <p>If you used to use <strong>stroongdog.netlify.app</strong>, the updated GitHub link is on the Discord in the same place you found the original link.</p>
              <h2>Use these buttons to copy your save data from this page (just strongdog.netlify.app currently) to transfer it over to another StrongDogXP page:</h2>
              <button id="get-polytrack-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Polytrack Save Data</button>
              <button id="get-cookie-clicker-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Cookie Clicker Save Data</button>
              <button id="get-babel-tower-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Babel Tower Save Data</button>
              <button id="get-idle-shark-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Idle Shark Save Data</button>
              <p>If you cannot figure out how to use these buttons or they simply don't work, report an error in the <a href="./about.html" target="_blank" style="color: deepskyblue">bug report form</a> or message us on Discord.</p>
              <h2><strong>DON'T FORGET TO SET NEW BOOKMARKS! THIS PAGE WILL BE GOING DOWN SOON!</strong></h2>
            </div>
          `;
          // Center the content for a better look
          document.body.style = "height: 100vh; margin: 0; display: grid; place-items: center;";

          const getPolytrackDataBtn = document.getElementById("get-polytrack-data");
          const getCookieClickerDataBtn = document.getElementById("get-cookie-clicker-data");
          const getBabelTowerDataBtn = document.getElementById("get-babel-tower-data");
          const getIdleSharkDataBtn = document.getElementById("get-idle-shark-data");

          // Get polytrack data
          getPolytrackDataBtn.addEventListener("click", () => getDataAndCopy(polytrackKeys));
          // Get cookie clicker data
          getCookieClickerDataBtn.addEventListener("click", () => getDataAndCopy(cookieClickerKey));
          // Get babel tower data
          getBabelTowerDataBtn.addEventListener("click", () => getDataAndCopy(babelTowerKeys));
          // Get idle shark data
          getIdleSharkDataBtn.addEventListener("click", () => getDataAndCopy(idleSharkKey));
        } else {
          // Importing user's save data
          const importSaveDataBtn = document.getElementById("import-save-data-btn");
          importSaveDataBtn.addEventListener("click", () => {
            alert(
              'After you dismiss this browser alert message, there may be a pop-up asking you to allow this page to "see text copied to the clipboard".\n\nTo be able to transfer your save data and continue, you MUST click ALLOW.'
            );
            navigator.clipboard
              .readText()
              .then(text => {
                const parsedData = JSON.parse(text);
                setDataInObject(parsedData);
              })
              .catch(err => alert(`Failed to read clipboard contents, check permissions: ${err}`));
          });
        }
      });

      import games from "./cards-data.js";
      import { siteMapping } from "./site-mapping.js";

      // Helper function to normalize game names
      function normalizeGameName(name) {
        return name
          .toLowerCase()
          .replace(/\s+/g, "")
          .replace(/[^a-z0-9]/g, "");
      }

      // Function to get the current site key from the URL
      function getCurrentSiteKey() {
        const currentURL = window.location.href;
        const keys = Object.keys(siteMapping);

        // Sort keys by length in descending order to match the most specific URL first
        keys.sort((a, b) => b.length - a.length);

        for (const key of keys) {
          if (currentURL.includes(key)) {
            return key;
          }
        }
        return null;
      }

      function getAdjustedUrls(href, imgSrc, page) {
        let adjustedHref = href;
        let adjustedImgSrc = `./img/${imgSrc}`; // Default img src

        const currentSiteKey = getCurrentSiteKey();

        if (currentSiteKey) {
          const currentSitePages = siteMapping[currentSiteKey];

          // Build a mapping from page number to base URL
          const pageNumberToURL = {};
          let currentPageNumber = getPageNumberFromURL(currentSiteKey);
          pageNumberToURL[currentPageNumber] = currentSiteKey;

          if (currentSitePages) {
            currentSitePages.forEach(url => {
              const pageNum = getPageNumberFromURL(url);
              pageNumberToURL[pageNum] = url;
            });
          }

          // Check if page is defined and not equal to currentPageNumber
          if (page !== undefined && page !== currentPageNumber) {
            let adjustedBaseURL = pageNumberToURL[page];

            if (!adjustedBaseURL) {
              // No base URL found, so construct one using the current site's base URL
              const currentOrigin = window.location.origin;
              adjustedBaseURL = `${currentOrigin}/strongdog${page}`;
            }

            // Remove leading './' from href and imgSrc if present
            const adjustedGameHref = href.replace(/^\.\//, "");
            adjustedHref = `${adjustedBaseURL}/${adjustedGameHref}`;

            const adjustedImgPath = imgSrc.replace(/^\.\//, "");
            adjustedImgSrc = `${adjustedBaseURL}/img/${adjustedImgPath}`;
          }
        } else {
          console.warn(`No site mapping found for current URL: ${window.location.href}`);

          // Since no site mapping is found, construct the adjusted URLs here
          if (page !== undefined && page > 1) {
            const currentOrigin = window.location.origin;
            const adjustedBaseURL = `${currentOrigin}/strongdog${page}`;

            // Remove leading './' from href and imgSrc if present
            const adjustedGameHref = href.replace(/^\.\//, "");
            adjustedHref = `${adjustedBaseURL}/${adjustedGameHref}`;

            const adjustedImgPath = imgSrc.replace(/^\.\//, "");
            adjustedImgSrc = `${adjustedBaseURL}/img/${adjustedImgPath}`;
          }
        }

        return { adjustedHref, adjustedImgSrc };
      }

      // Function to extract the page number from a URL or key
      function getPageNumberFromURL(url) {
        const regex = /(strongdog|mathcord|stroongdog)(\d*)/;
        const match = url.match(regex);
        if (match) {
          const pageNum = match[2];
          if (pageNum === "") {
            return 1;
          } else {
            return parseInt(pageNum, 10);
          }
        } else {
          return 1; // Default to page 1 if not found
        }
      }

      // Function to generate card HTML
      function getCardHTML(gameObject) {
        const { href, imgSrc, name, page } = gameObject;
        const { adjustedHref, adjustedImgSrc } = getAdjustedUrls(href, imgSrc, page);

        // Generate a normalized game ID for matching
        const gameId = normalizeGameName(name);

        return `
          <a href="${adjustedHref}" class="card" data-game-id="${gameId}" data-page="${page}">
            <img src="${adjustedImgSrc}">
            <figcaption>${name}</figcaption>
          </a>
        `;
      }

      // Generate the cards
      let cardsHTMLArr = [];
      for (let i = 0; i < games.length; ++i) {
        cardsHTMLArr.push(getCardHTML(games[i]));
      }

      const cardsHTMLStr = cardsHTMLArr.join("");

      // Insert the cards into the DOM once the content is loaded
      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("allGameList").innerHTML = cardsHTMLStr;

        // --- Begin Updated Search Functionality ---
        const searchInput = document.querySelector(".search-bar");
        const searchResults = document.getElementById("searchResults");

        if (!searchInput || !searchResults) {
          console.error("Search input or results container not found in the DOM.");
          return;
        }

        // Show results when the search bar is focused
        searchInput.addEventListener("focus", function () {
          updateSearchResults(); // Display initial results if any
        });

        // Update the search results based on the input
        searchInput.addEventListener("input", updateSearchResults);

        // Hide results when clicking outside the search bar and results
        document.addEventListener("click", function (event) {
          if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
            searchResults.style.display = "none";
          }
        });

        function updateSearchResults() {
          const searchText = searchInput.value.toLowerCase();
          const filteredGames = games.filter(game => game.name.toLowerCase().includes(searchText)).slice(0, 7); // Limit to top 7 results

          searchResults.innerHTML = ""; // Clear previous results

          if (filteredGames.length === 0) {
            searchResults.style.display = "none";
            return;
          }

          filteredGames.forEach(game => {
            const { href, imgSrc, name, page } = game;
            const { adjustedHref, adjustedImgSrc } = getAdjustedUrls(href, imgSrc, page);

            const resultLink = document.createElement("a");
            resultLink.href = adjustedHref;
            resultLink.innerHTML = `
              <img src="${adjustedImgSrc}" alt="${name}">
              <span>${name}</span>
            `;
            searchResults.appendChild(resultLink);
          });

          searchResults.style.display = "block"; // Show results
        }
        // --- End Updated Search Functionality ---
      });
    </script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBh-VnGiP4qZD0r14gfn9dr77GwtslpTqU",
        authDomain: "strongdog-auth.firebaseapp.com",
        databaseURL: "https://strongdog-auth-default-rtdb.firebaseio.com",
        projectId: "strongdog-auth",
        storageBucket: "strongdog-auth.appspot.com",
        messagingSenderId: "936276282572",
        appId: "1:936276282572:web:a802b7f609381ff9428669",
        measurementId: "G-0YLTCV2MMS",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Initialize Firebase Authentication and Firestore
      const auth = firebase.auth();
      const db = firebase.firestore();
    </script>
    <script src="appscript.js"></script>
    <script>
      // Define normalizeGameName function
      function normalizeGameName(name) {
        return name
          .toLowerCase()
          .replace(/\s+/g, "")
          .replace(/[^a-z0-9]/g, "");
      }

      document.addEventListener("DOMContentLoaded", function () {
        const topGameList = document.getElementById("topGameList");
        const loadingContainerEl = document.createElement("div");
        loadingContainerEl.className = "loading-container";
        loadingContainerEl.innerHTML = `
          <div class="bars">
            <div class="bar bar-1"></div>
            <div class="bar bar-2"></div>
            <div class="bar bar-3"></div>
            <div class="bar bar-4"></div>
            <div class="bar bar-5"></div>
          </div>
        `;

        // Append loadingContainerEl to topGameList
        topGameList.appendChild(loadingContainerEl);

        function fetchTopGames() {
          fetch(targetUrl, {
            // Use the targetUrl from appscript.js
            method: "GET",
          })
            .then(response => {
              if (!response.ok) {
                throw new Error("Network response was not ok " + response.statusText);
              }
              return response.json();
            })
            .then(data => {
              if (data && data.content) {
                const parsedData = JSON.parse(data.content);
                console.log("Parsed data:", parsedData);
                displayTopGames(parsedData);
              } else {
                console.error("Invalid data format", data);
              }
            })
            .catch(error => console.error("Error:", error))
            .finally(() => {
              loadingContainerEl.style.display = "none";
            });
        }

        function displayTopGames(games) {
          if (!topGameList) {
            console.error("Required element not found.");
            return;
          }
          topGameList.innerHTML = "";

          games.slice(1).forEach(game => {
            // Skip the first entry as it is the header
            const gameName = game[0];
            const matchingCard = findMatchingCard(gameName);
            if (matchingCard) {
              topGameList.appendChild(matchingCard.cloneNode(true));
            } else {
              console.warn(`No matching card found for game: ${gameName}`);
            }
          });
        }

        function findMatchingCard(gameName) {
          const formattedGameName = normalizeGameName(gameName);
          const cards = document.querySelectorAll("#allGameList .card");
          for (let card of cards) {
            const cardGameId = card.getAttribute("data-game-id");
            if (cardGameId === formattedGameName) {
              return card;
            }
          }
          console.warn(`Card not found for game: ${gameName} (ID: ${formattedGameName})`);
          return null;
        }

        // Immediately invoked function to run fetchTopGames as soon as possible
        (function () {
          loadingContainerEl.style.display = "flex"; // Show spinner
          fetchTopGames();
        })();
      });
    </script>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StrongDog XP</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #2e2e2e;
        /* Dark grey background */
      }

      .navbar {
        background-color: #333;
        color: white;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        position: relative;
        justify-content: space-between;
        /* Keep items spread out */
      }

      .logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        /* Center the logo horizontally */
        color: white;
        font-weight: bold;
      }

      /* Style for the menu icon */
      .menu-icon {
        font-size: 2rem;
        cursor: pointer;
        margin-left: 20px;
        /* Position the icon to the left */
        color: white;
        position: relative;
        z-index: 1001;
        /* Ensure it stays on top when clicking */
      }

      .slide-menu {
        position: fixed;
        top: 0;
        height: 100%;
        width: 350px;
        background-color: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(10px);
        /* You can adjust to preferred blurring */
        color: white;
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
        z-index: 1003;
        /* Ensure it covers the menu icon when it slides in */
        transition: transform 0.4s ease;
        /* Smooth slide-in animation */
        overflow-y: auto;
        transform: translateX(-100%);
        /* Start off-screen completely */
      }

      .profile-picture {
        width: 100%;
        height: 100%;
        object-fit: cover;
        /* Keeps the aspect-ratio of image normal - no distortions */
      }

      .profile-picture-container {
        border-radius: 50%;
        width: 100px;
        aspect-ratio: 1;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      }

      .user-details-container {
        display: flex;
        width: 100%;
        justify-content: center;
        gap: 20px;
        padding-block: 40px;
      }

      .username-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .username-text {
        font-size: 1.5rem;
      }

      .categories {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      /* Styling for links in the slide menu */
      .categories > a {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 20px;
        text-decoration: none;
        color: white;
        transition: all 0.3s ease;
        margin-left: 20px;
        margin-right: 20px;
        text-align: center;
        font-size: 1.1rem;
        position: relative;
        overflow: hidden;
      }

      .categories > a::after {
        content: "";
        background: rgba(255, 255, 255, 0.1);
        /* You can change the color to your liking */
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border-radius: 50%;
        width: 0;
        height: 0;
        transition: 0.4s ease-out;
        /* z-index: -1; */
      }

      .categories > a:hover::after {
        width: 400px;
        height: 400px;
      }

      .categories > a:hover {
        transform: scale(0.95);
      }

      /* Styling for the "new" tags */
      span.new-feature-tag {
        background: orange;
        border-radius: 100vw;
        /* Completely rounded edges */
        padding: 0.2rem 0.4rem;
        margin-left: 1rem;
        /* Separate the tag from the left text */
        font-size: 0.6rem;
        color: black;
        text-transform: uppercase;
      }

      .navbar .logo {
        color: white;
        font-weight: bold;
      }

      .navbar .logo .xp {
        color: orange;
      }

      .navbar a,
      .navbar a:visited,
      .navbar .logo span {
        text-decoration: none;
        margin-right: 20px;
      }

      .search-bar {
        padding: 7px;
        padding-top: 10px;
        font-size: 1em;
        border-radius: 20%;
        width: 100%;
        border: none;
        border-bottom: 5px solid gray;
        background-color: transparent;
        color: white;
      }

      .search-bar:focus {
        outline: none;
        background-color: rgba(255, 255, 255, 0.1);
      }

      .games-grid {
        display: flex;
        flex-wrap: wrap;
        padding: 10px;
        justify-content: center;
      }

      .card {
        background-color: #fff;
        border-radius: 10px;
        margin: 5px;
        /* Reduced margin */
        width: 120px;
        height: 120px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
      }

      .card:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.29);
      }

      .card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
      }

      .card:hover img {
        transform: scale(1.02);
        /* subtle zoom on the image */
      }

      .card figcaption {
        position: absolute;
        bottom: -30px;
        /* start hidden */
        left: 0;
        width: 100%;
        background-color: rgb(74, 74, 74);
        color: white;
        text-align: center;
        padding: 5px;
        transition: bottom 0.5s ease;
        /* smoother and slower */
        overflow: hidden;
      }

      .card:hover figcaption {
        bottom: 0;
        /* slide up on hover */
      }

      .card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          to right,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.3) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        transform: rotate(30deg) translate(-50%, -50%);
        transition: transform 0.5s, opacity 0.5s;
        opacity: 0;
        pointer-events: none;
        /* This ensures the shine doesn't interfere with clicking the card */
      }

      .card:hover::before {
        transform: rotate(30deg) translate(100%, -50%);
        opacity: 1;
      }

      .search-results {
        position: absolute;
        right: 20px;
        top: 60px;
        background-color: white;
        color: black;
        border: 1px solid #ccc;
        width: 250px;
        /* Adjusted for image display */
        display: none;
        z-index: 1000;
        transform-origin: left;
        /* Anchor the transformation to the left */
        transition: transform 0.3s ease, background-color 0.3s ease;
        border-radius: 5px;
        /* Rounded corners for the search results box */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .search-results a {
        display: flex;
        align-items: center;
        text-decoration: none;
        color: black;
        border-bottom: 1px solid #eee;
        padding: 5px;
        transition: all 0.3s ease;
      }

      .search-results img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-right: 10px;
        border-radius: 5px;
      }

      .search-results a:last-child {
        border-bottom: none;
      }

      .news-container {
        margin: 20px auto;
        padding: 20px;
        background-color: #444444;
        /* Light grey background */
        border-radius: 8px;
        max-width: 800px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        /* Subtle shadow for depth */
      }

      .news {
        color: #ffffff;
        /* Dark text for readability */
      }

      .credits-title {
        font-size: 1.5em;
        margin-bottom: 15px;
        color: #ffffff;
        /* Darker title color */
        border-bottom: 2px solid #ddd;
        /* Subtle bottom border */
        padding-bottom: 5px;
      }

      .credits-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
      }

      .credits-role {
        font-weight: bold;
        color: #ffffff;
        /* Slightly lighter for role text */
      }

      .credits-names {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        /* Center-aligns items vertically */
      }

      .credits-link {
        color: #0073e6;
        /* Blue link color */
        text-decoration: none;
        font-weight: bold;
        /* Bold links for emphasis */
      }

      .credits-link:hover {
        text-decoration: underline;
      }

      .credits-names span {
        color: #c4c4c4;
        /* Slightly lighter for plain text */
      }

      /* Additional CSS for better spacing and style */
      .credits-item:last-child .credits-names {
        gap: 16px;
      }

      .credits-item:last-child .credits-link {
        color: #00b3b3;
        /* Different link color for Other Links */
      }

      .credits-item:last-child .credits-link:hover {
        text-decoration: underline;
        color: #00cccc;
        /* Hover color for Other Links */
      }

      /* Styling for the All  label */
      h2 {
        text-align: center;
        color: white;
        margin: 20px 0;
        /* Spacing above and below */
        font-size: 1.5em;
        /* Larger font size */
      }

      .card figcaption {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: rgba(95, 95, 95, 0.8);
        color: black;
        padding: 5px 0;
        transition: transform 0.3s ease, opacity 0.3s ease;
        transform: translateY(100%);
        /* Start off-screen */
        opacity: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        text-shadow: 0 0 2px white;
        font-weight: 550;
        border-radius: 10px;
      }

      .card:hover figcaption {
        height: 30px;
        /* Show text on hover */
        background-color: rgba(95, 95, 95, 0.8);
        /* Non-transparent background on hover */
        transform: translateY(0);
        /* Slide up to visible */
        opacity: 1;
      }

      .pagination {
        text-align: center;
        margin: 20px 0;
      }

      .pagination a {
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        transition: background-color 0.3s;
        border: 1px solid #444;
        margin: 0 4px;
        border-radius: 4px;
        background-color: #333;
      }

      .pagination a.active {
        background-color: #555;
        border-color: #777;
      }

      .pagination a:hover:not(.active) {
        background-color: #444;
      }

      .updates-paragraph-text {
        color: white;
        background-color: #a83632;
        padding: 15px 10px;
        border-radius: 10px;
        box-shadow: 0 0 10px 5px rgba(255, 255, 255, 0.05);
        margin-bottom: 30px;
      }

      .updates-text-container {
        margin-left: 30%;
        margin-right: 30%;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .loading-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .bars {
        display: flex;
        align-items: center;
      }

      .bar {
        background-color: rgba(255, 255, 255, 0.3);
        width: 20px;
        height: 40px;
        margin-right: 5px;
        border-radius: 10px;
        animation: load ease infinite 5s;
      }

      .bar-2,
      .bar-4 {
        height: 50px;
      }

      .bar-2 {
        animation-delay: 0.1s;
      }

      .bar-3 {
        height: 60px;
        animation-delay: 0.2s;
      }

      .bar-4 {
        animation-delay: 0.3s;
      }

      .bar-5 {
        animation-delay: 0.4s;
      }

      @keyframes load {
        0%,
        100% {
          transform: rotate(0deg);
        }

        50% {
          transform: rotate(720deg) rotateX(180deg);
        }
      }

      #topGameList {
        position: relative;
        /* Make sure topGameList is relatively positioned */
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background-color: #757575;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
        text-align: center;
      }

      .modal-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }

      .modal-close:hover,
      .modal-close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
      }

      .modal-link {
        color: blue;
        text-decoration: underline;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div
      id="secretLink"
      title="Secret Menu"
      style="
        position: absolute;
        top: 10px;
        right: 10px;
        width: 10px;
        height: 10px;
        cursor: pointer;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000; /* Ensure it is on top */
      "
    ></div>
    <script>
      // Ensure the secretLink event listener is set up after the element is loaded
      window.addEventListener("load", function () {
        const secretLink = document.getElementById("secretLink");
        secretLink.addEventListener("click", function () {
          window.location.href = "secret-menu.html";
        });
      });
    </script>

    <div class="navbar">
      <div class="menu-icon" id="menuIcon">&#9776;</div>
      <a href="index.html" class="logo">StrongDog<span class="xp">XP</span></a>

      <div class="search-container">
        <input type="text" class="search-bar" placeholder="Search for games..." id="searchInput" autocomplete="off" />
        <div class="search-results" id="searchResults"></div>
      </div>
    </div>
    <div class="updates-text-container">
      <p class="updates-paragraph-text">
        If you want to transfer your save data from popular games like Polytrack, Cookie Clicker and more that were on
        Netlify pages, head over to the
        <a href="https://strongdog.netlify.app" style="color: deepskyblue;">Netlify</a> hosted page to recieve more
        information. If you need to import your save data, click the button below:
        <button
          id="import-save-data-btn"
          style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer; margin-inline: auto; display: block;"
        >
          <strong>Import Save Data</strong>
        </button>
      </p>
    </div>
    <div class="modal" id="popupModal">
      <div class="modal-content">
        <span class="modal-close" id="closeModal">&times;</span>
        <p>
          The strongdog discord server is a place for strongdog users to chill, play games together, request ideas, and
          have fun!
        </p>
        <p>
          If you want to help on StrongDog, there is a chat where you can get help downloading games, and you can upload
          games YOU download to add to StrongDog! (And yes, you WILL get credit for downloading games)
        </p>
        <p>
          Ready to join? Click
          <a href="https://discord.gg/pWjfQ4Sz5c" target="_blank">here</a> to join the Discord server!
        </p>
      </div>
    </div>
    <h2 style="text-align: center"><strong>Top 10</strong></h2>
    <div class="games-grid" id="topGameList"></div>

    <h2 style="text-align: center"><strong>All</strong></h2>
    <div class="games-grid" id="allGameList"></div>

    <h2 style="text-align: center"><strong>StrongDogXP LLC</strong></h2>

    <div class="news-container">
      <div class="news">
        <div class="credits-item">
          <div class="credits-role">CEO</div>
          <div class="credits-names">
            <a href="https://github.com/jman1593" target="_blank" class="credits-link">Joshua Pettit</a>
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">Developers</div>
          <div class="credits-names">
            <a href="https://github.com/JamesMeadows4" target="_blank" class="credits-link">James Meadows</a>
            <span>|</span>
            <a href="https://github.com/jman1593" target="_blank" class="credits-link">Joshua Pettit</a>
            >
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">Game Downloaders</div>
          <div class="credits-names">
            <a href="https://github.com/jman1593" target="_blank" class="credits-link">Joshua Pettit</a>
          </div>
          <span>|</span>
          <a href="https://maxwellstevenson.com" target="_blank" class="credits-link">Maxwell Stevenson</a>
        </div>
        <div class="credits-item">
          <div class="credits-role">Other Links</div>
          <div class="credits-names">
            <a href="https://strongdogxp.github.io" target="_blank" class="credits-link">strongdogxp.github.io</a>
            <span>|</span>
            <a href="https://mathcord.netlify.app" target="_blank" class="credits-link">mathcord.netlify.app</a>
            <span>|</span>
            <a href="https://jman1593.github.io" target="_blank" class="credits-link">jman1593.github.io</a>
            <span>|</span>
            <a href="https://strongdog.netlify.app" target="_blank" class="credits-link">strongdog.netlify.app</a>
            <span>|</span>
            <a href="https://strongdog-1.vercel.app" target="_blank" class="credits-link">strongdog-1.vercel.app</a>
            <span>|</span>
            <a href="https://mathcord.com" target="_blank" class="credits-link">mathcord.com</a>
            <span>|</span>
            <a href="https://strongdog.com" target="_blank" class="credits-link">strongdog.com</a>
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">MORE UNBLOCKED LINKS ON THE DISCORD</div>
        </div>
      </div>
    </div>
    <div class="slide-menu" id="slideMenu">
      <div class="user-details-container">
        <div class="profile-picture-container">
          <a href="settings.html">
            <img class="profile-picture" src="img/default-avatar.png" />
          </a>
        </div>
        <div class="username-container">
          <p class="username-text">Your Username</p>
        </div>
      </div>
      <!-- Categories / options -->
      <div class="categories">
        <a href="favs.html" class="option-link">Favorites</a>
        <a href="#" id="randomGame" class="option-link">Random Game</a>
        <a href="#" id="blockLanschool" class="option-link">Block Lanschool</a>
        <a href="about.html" class="option-link">About / Report Bugs / Request Games</a>
        <a href="https://discord.gg/pWjfQ4Sz5c" class="option-link"
          >Discord Server<span class="new-feature-tag">new</span></a
        >
      </div>
    </div>
    <script type="module">
      import games from "./cards-data.js";

      document.addEventListener("DOMContentLoaded", function () {
        const menuIcon = document.getElementById("menuIcon");
        const slideMenu = document.createElement("div");
        slideMenu.className = "slide-menu";

        // Clone the categories
        const originalCategories = document.querySelector(".categories");
        const categories = originalCategories.cloneNode(true);

        // Append the categories to the slideMenu
        slideMenu.appendChild(categories);
        document.body.appendChild(slideMenu);

        // Add click event to toggle the sliding menu
        menuIcon.addEventListener("click", function (event) {
          event.stopPropagation(); // Prevent click event from bubbling up
          if (slideMenu.style.transform === "translateX(0%)") {
            slideMenu.style.transform = "translateX(-100%)"; // Hide menu by sliding out
          } else {
            slideMenu.style.transform = "translateX(0%)"; // Show menu by sliding in
          }
        });

        // Close the menu when clicking outside of it
        window.addEventListener("click", function (event) {
          if (event.target !== menuIcon && !slideMenu.contains(event.target)) {
            slideMenu.style.transform = "translateX(-100%)"; // Hide menu
          }
        });

        // Check authentication state
        auth.onAuthStateChanged(async user => {
          let userDetailsContainer;

          if (user) {
            // User is signed in, fetch their profile picture and username

            // Clone the user-details-container
            const originalUserDetailsContainer = document.querySelector(".user-details-container");
            userDetailsContainer = originalUserDetailsContainer.cloneNode(true);

            // Get elements inside userDetailsContainer
            const profilePictureElement = userDetailsContainer.querySelector(".profile-picture");
            const usernameElement = userDetailsContainer.querySelector(".username-text");

            // Set profile picture
            if (user.photoURL) {
              profilePictureElement.src = user.photoURL;
            } else {
              profilePictureElement.src = "img/default-avatar.png"; // Fallback to default image
            }

            // Set username
            const userId = user.uid;
            const userDocRef = db.collection("usernames").doc(userId);
            const userDoc = await userDocRef.get();

            if (userDoc.exists) {
              const userData = userDoc.data();
              usernameElement.textContent = userData.username || "Username";
            } else {
              usernameElement.textContent = user.displayName || "Username";
            }

            // Make profile picture clickable and direct to settings page
            profilePictureElement.parentElement.addEventListener("click", () => {
              window.location.href = "settings.html";
            });

            // Insert the userDetailsContainer at the top of the slideMenu
            slideMenu.insertBefore(userDetailsContainer, categories);

            // Create the "Log Out" button as a menu item
            const logoutLink = document.createElement("a");
            logoutLink.href = "#";
            logoutLink.className = "option-link";
            logoutLink.textContent = "Log Out";
            logoutLink.style.backgroundColor = "#dc3545"; // Red color for the button
            logoutLink.style.color = "white";

            // Add click event to the "Log Out" link
            logoutLink.addEventListener("click", function (e) {
              e.preventDefault();
              auth
                .signOut()
                .then(() => {
                  // Sign-out successful.
                  window.location.reload();
                })
                .catch(error => {
                  // An error happened.
                  console.error("Error signing out:", error);
                });
            });

            // Insert the "Log Out" link above the "Favorites" link
            const favoritesLink = categories.querySelector('a[href="favs.html"]');
            categories.insertBefore(logoutLink, favoritesLink);

            try {
              const accessDocRef = db.collection("access").doc(user.uid);
              const accessDoc = await accessDocRef.get();

              if (accessDoc.exists) {
                const accessData = accessDoc.data();
                console.log();

                if (accessData.tester === true) {
                  const testGamesLink = document.createElement("a");
                  testGamesLink.href = "test.html";
                  testGamesLink.className = "option-link";
                  testGamesLink.textContent = "Test Games";
                  testGamesLink.style.backgroundColor = "#28a745";
                  testGamesLink.style.color = "white";
                  testGamesLink.style.marginTop = "10px";

                  testGamesLink.addEventListener("mouseover", function () {
                    testGamesLink.style.backgroundColor = "#218838";
                  });
                  testGamesLink.addEventListener("mouseout", function () {
                    testGamesLink.style.backgroundColor = "#28a745";
                  });

                  categories.insertBefore(testGamesLink, favoritesLink);
                } else {
                  console.log();
                }
              } else {
                console.log();
              }
            } catch (error) {
              console.error();
            }
            try {
              const accessDocRef = db.collection("access").doc(user.uid);
              const accessDoc = await accessDocRef.get();

              if (accessDoc.exists) {
                const accessData = accessDoc.data();
                console.log();

                if (accessData.admin) {
                  const testGamesLink = document.createElement("a");
                  testGamesLink.href = "admin.html";
                  testGamesLink.className = "option-link";
                  testGamesLink.textContent = "Admin Panel";
                  testGamesLink.style.backgroundColor = "#bd0000";
                  testGamesLink.style.color = "white";
                  testGamesLink.style.marginTop = "10px";

                  testGamesLink.addEventListener("mouseover", function () {
                    testGamesLink.style.backgroundColor = "#ff0000";
                  });
                  testGamesLink.addEventListener("mouseout", function () {
                    testGamesLink.style.backgroundColor = "#bd0000";
                  });

                  categories.insertBefore(testGamesLink, favoritesLink);
                } else {
                  console.log();
                }
              } else {
                console.log();
              }
            } catch (error) {
              console.error();
            }
          } else {
            // User is not signed in, display "Not logged in" and a "Log In" button

            // Create a new userDetailsContainer
            userDetailsContainer = document.createElement("div");
            userDetailsContainer.className = "user-details-container";

            // Create a container for the text
            const notLoggedInContainer = document.createElement("div");
            notLoggedInContainer.className = "username-container";

            // Create the "Not logged in" text
            const notLoggedInText = document.createElement("p");
            notLoggedInText.className = "username-text";
            notLoggedInText.textContent = "Not logged in";

            // Append the text to the container
            notLoggedInContainer.appendChild(notLoggedInText);

            // Create the "Log In" button
            const loginButton = document.createElement("button");
            loginButton.textContent = "Log In";
            loginButton.style.backgroundColor = "#007bff"; // Blue color
            loginButton.style.color = "white";
            loginButton.style.border = "none";
            loginButton.style.padding = "10px 20px";
            loginButton.style.fontSize = "16px";
            loginButton.style.borderRadius = "5px";
            loginButton.style.cursor = "pointer";
            loginButton.style.marginTop = "5px";

            // Add click event to the "Log In" button
            loginButton.addEventListener("click", function () {
              window.location.href = "login.html";
            });

            // Center the content
            userDetailsContainer.style.display = "flex";
            userDetailsContainer.style.flexDirection = "column";
            userDetailsContainer.style.alignItems = "center";
            userDetailsContainer.style.paddingBlock = "40px"; // Ensure consistent padding

            // Append the text and button to the userDetailsContainer
            userDetailsContainer.appendChild(notLoggedInContainer);
            userDetailsContainer.appendChild(loginButton);

            // Insert the userDetailsContainer at the top of the slideMenu
            slideMenu.insertBefore(userDetailsContainer, categories);
          }

          // Add event listeners to the relevant buttons in the sliding menu
          categories.querySelector("#randomGame").addEventListener("click", function (e) {
            e.preventDefault();
            handleRandomGameClick();
          });

          categories.querySelector("#blockLanschool").addEventListener("click", function (e) {
            e.preventDefault();
            handleBlockLanschoolClick();
          });

          function handleRandomGameClick() {
            if (games.length > 0) {
              const randomIndex = Math.floor(Math.random() * games.length);
              const randomGamePath = games[randomIndex].href;
              window.location.href = randomGamePath;
            } else {
              console.error("No game paths available for selection.");
            }
          }

          function handleBlockLanschoolClick() {
            var url = "https://strongdog.netlify.app";
            var newTab = window.open();
            newTab.document.write(`
              <html>
                <body style="margin: 0; height: 100vh;">
                  <iframe src="${url}" style="border: none; width: 100%; height: 100%;"></iframe>
                </body>
              </html>
            `);
            newTab.document.close();
          }
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const discordLink = document.getElementById("discordLink");
        const modal = document.getElementById("popupModal");
        const closeModal = document.getElementById("closeModal");

        discordLink.addEventListener("click", function () {
          modal.style.display = "flex";
        });

        closeModal.addEventListener("click", function () {
          modal.style.display = "none";
        });

        window.addEventListener("click", function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        });
      });
    </script>
    <script type="module">
      import games from "./cards-data.js";
      import { siteMapping } from "./site-mapping.js";

      document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.querySelector(".search-bar");
        const searchResults = document.getElementById("searchResults");

        if (!searchInput || !searchResults) {
          console.error("Search input or results container not found in the DOM.");
          return;
        }

        // Show results when the search bar is focused
        searchInput.addEventListener("focus", function () {
          updateSearchResults(); // Display initial results if any
        });

        // Update the search results based on the input
        searchInput.addEventListener("input", updateSearchResults);

        // Hide results when clicking outside the search bar and results
        document.addEventListener("click", function (event) {
          if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
            searchResults.style.display = "none";
          }
        });

        function updateSearchResults() {
          const searchText = searchInput.value.toLowerCase();
          const filteredGames = games.filter(game => game.name.toLowerCase().includes(searchText)).slice(0, 7); // Limit to top 7 results

          searchResults.innerHTML = ""; // Clear previous results

          if (filteredGames.length === 0) {
            searchResults.style.display = "none";
            return;
          }

          const currentURL = window.location.href;
          let matchedKey = null;

          // Find the matching key based on the current URL
          for (const key in siteMapping) {
            if (currentURL.includes(key)) {
              matchedKey = key;
              break;
            }
          }

          if (!matchedKey) console.warn(`No site mapping found for current URL: ${currentURL}`);

          filteredGames.forEach(game => {
            const { href, imgSrc, name, page } = game;
            let adjustedHref = href;
            let adjustedImgSrc = `./img/${imgSrc}`; // Default img src

            if (page >= 2 && matchedKey) {
              // Handle pages 2 and above
              const pageIndex = page - 2; // Indexing starts at 0
              const pageBaseURLs = siteMapping[matchedKey];

              if (pageBaseURLs && pageIndex < pageBaseURLs.length) {
                const pageBaseURL = pageBaseURLs[pageIndex];

                // Remove leading './' from href and imgSrc if present
                const adjustedGameHref = href.replace(/^\.\//, "");
                adjustedHref = `${pageBaseURL}/${adjustedGameHref}`;

                const adjustedImgPath = imgSrc.replace(/^\.\//, "");
                adjustedImgSrc = `${pageBaseURL}/img/${adjustedImgPath}`;
              } else {
                console.warn(`No site mapping found for page ${page} on hostname: ${matchedKey}`);
              }
            }

            const resultLink = document.createElement("a");
            resultLink.href = adjustedHref;
            resultLink.innerHTML = `
              <img src="${adjustedImgSrc}" alt="${name}">
              <span>${name}</span>
            `;
            searchResults.appendChild(resultLink);
          });

          searchResults.style.display = "block"; // Show results
        }
      });
    </script>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const page1Link = document.getElementById("page1-link");
      const page2Link = document.getElementById("page2-link");
      const hostname = window.location.hostname;

      // Configuration object mapping hostnames to link values
      const linkMap = {
        "jman1593.github.io": { page1: "/#", page2: "/strongdog2/index.html" },
        "strongdog-1.vercel.app": {
          page1: "https://strongdog-1.vercel.app",
          page2: "https://strongdog2.vercel.app",
        },
        "strongdog2.vercel.app": {
          page1: "https://strongdog-1.vercel.app",
          page2: "https://strongdog2.vercel.app",
        },
        "strongdog.netlify.app": {
          page1: "https://strongdog.netlify.app",
          page2: "https://strongdog2.netlify.app",
        },
        "strongdog2.netlify.app": {
          page1: "https://strongdog.netlify.app",
          page2: "https://strongdog2.netlify.app",
        },
        "mathcord.netlify.app": {
          page1: "https://mathcord.netlify.app",
          page2: "https://mathcord2.netlify.app",
        },
        "mathcord2.netlify.app": {
          page1: "https://mathcord.netlify.app",
          page2: "https://mathcord2.netlify.app",
        },
        "strongdog.onrender.com": {
          page1: "https://strongdog.onrender.com",
          page2: "https://strongdog2.onrender.com",
        },
        "stroongdog.netlify.app": {
          page1: "https://stroongdog.netlify.app",
          page2: "https://stroongdog2.netlify.app",
        },
        "stroongdog2.netlify.app": {
          page1: "https://stroongdog.netlify.app",
          page2: "https://stroongdog2.netlify.app",
        },
      };

      // Find matching hostname and set hrefs accordingly
      for (const key in linkMap) {
        if (hostname.includes(key)) {
          page1Link.href = linkMap[key].page1;
          page2Link.href = linkMap[key].page2;
          break; // stop once a match is found
        }
      }
    });
  </script>
  <script>
    document.getElementById("secretLink").addEventListener("click", function () {
      window.location.href = "secret-menu.html";
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const discordLink = document.getElementById("discordLink");
      const modal = document.getElementById("popupModal");
      const closeModal = document.getElementById("closeModal");

      discordLink.addEventListener("click", function () {
        modal.style.display = "flex";
      });

      closeModal.addEventListener("click", function () {
        modal.style.display = "none";
      });

      window.addEventListener("click", function (event) {
        if (event.target === modal) {
          modal.style.display = "none";
        }
      });
    });
  </script>
  <script type="module">
    import games from "./cards-data.js";

    document.addEventListener("DOMContentLoaded", function () {
      const randomGameButton = document.getElementById("randomGame");

      function handleRandomGameClick() {
        if (games.length > 0) {
          const randomIndex = Math.floor(Math.random() * games.length);
          const randomGamePath = games[randomIndex].href;
          window.location.href = randomGamePath;
        } else {
          console.error("No game paths available for selection.");
        }
      }

      // Add event listener to Random Game button
      randomGameButton.addEventListener("click", function (event) {
        event.preventDefault();
        handleRandomGameClick();
      });
    });
  </script>
</html>
